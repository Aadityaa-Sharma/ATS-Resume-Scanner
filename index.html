<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Resume Intelligence System</title>
  <style>
    /* -------------------- RESET -------------------- */
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* -------------------- GLOBAL -------------------- */
    body {
      font-family: 'Inter', 'Segoe UI', Tahoma, sans-serif;
      background: #f7f9fc;
      color: #333;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    h1, h2, h3, h4 {
      font-weight: 600;
      letter-spacing: -0.5px;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* -------------------- HEADER -------------------- */
    .header {
      background: white;
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      text-align: center;
      margin-bottom: 20px;
    }

    .header h1 {
      font-size: 2rem;
      color: #4b6ef5;
      margin-bottom: 0.5rem;
      animation: fadeDown 0.8s ease;
    }

    .header p {
      color: #666;
      font-size: 1rem;
      animation: fadeUp 0.8s ease;
    }

    /* -------------------- UPLOAD SECTION -------------------- */
    .upload-section {
      text-align: center;
      background: white;
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.3s ease;
    }

    .upload-section:hover {
      transform: translateY(-3px);
    }

    .upload-area {
      border: 2px dashed #4b6ef5;
      border-radius: 12px;
      padding: 2rem;
      background: #f0f4ff;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.3s ease;
      margin-bottom: 1rem;
    }

    .upload-area:hover {
      background: #e8edff;
      transform: scale(1.02);
    }

    .upload-area.dragover {
      background: #d8e0ff;
    }

    .upload-icon {
      font-size: 3rem;
      margin-bottom: 10px;
      color: #4b6ef5;
    }

    .upload-text {
      font-size: 1.2rem;
      font-weight: 500;
    }

    .upload-subtext {
      font-size: 0.9rem;
      color: #777;
    }

    .upload-btn {
      background: #4b6ef5;
      color: white;
      border: none;
      padding: 0.8rem 2rem;
      border-radius: 30px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
    }

    .upload-btn:hover {
      background: #3757d4;
      transform: translateY(-2px);
    }

    /* -------------------- LOADING -------------------- */
    .loading {
      display: none;
      background: white;
      padding: 2rem;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid #eee;
      border-top: 5px solid #4b6ef5;
      border-radius: 50%;
      margin: 0 auto 20px;
      animation: spin 1s linear infinite;
    }

    /* -------------------- RESULTS -------------------- */
    .results {
      display: none;
    }

    .score-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .score-card {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      text-align: center;
      transition: transform 0.3s ease;
    }

    .score-card:hover {
      transform: translateY(-4px);
    }

    .score-card .icon {
      font-size: 2rem;
      margin-bottom: 8px;
    }

    .score-card .value {
      font-size: 1.8rem;
      font-weight: 600;
      color: #4b6ef5;
    }

    .score-card .label {
      color: #777;
      font-size: 0.9rem;
    }

    /* -------------------- ANALYSIS -------------------- */
    .analysis-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      margin-bottom: 20px;
      overflow: hidden;
    }

    .analysis-header {
      background: #4b6ef5;
      color: white;
      padding: 1rem;
      font-weight: 500;
    }

    .analysis-content {
      padding: 1.5rem;
    }

    /* -------------------- FOOTER -------------------- */
    footer {
      text-align: center;
      font-size: 0.8rem;
      color: #999;
      margin-top: 30px;
      padding: 10px;
    }

    /* -------------------- ANIMATIONS -------------------- */
    @keyframes spin {
      0% {transform: rotate(0);}
      100% {transform: rotate(360deg);}
    }

    @keyframes fadeDown {
      from {opacity:0; transform:translateY(-10px);}
      to {opacity:1; transform:translateY(0);}
    }

    @keyframes fadeUp {
      from {opacity:0; transform:translateY(10px);}
      to {opacity:1; transform:translateY(0);}
    }

    /* -------------------- RESPONSIVE -------------------- */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.6rem;
      }
      .upload-text {
        font-size: 1rem;
      }
      .upload-btn {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>🎯 AI Resume Intelligence System</h1>
      <p>Advanced ATS Analysis & Job Profile Matching</p>
    </div>

    <!-- Upload Section -->
    <div class="upload-section" id="uploadSection">
      <div class="upload-area" id="uploadArea">
        <div class="upload-icon">📄</div>
        <div class="upload-text">Drag & Drop your resume here</div>
        <div class="upload-subtext">or click to browse (PDF files only)</div>
      </div>
      <input type="file" id="fileInput" class="file-input" accept=".pdf" hidden>
      <button class="upload-btn" onclick="document.getElementById('fileInput').click()">Choose Resume File</button>
    </div>

    <!-- Loading -->
    <div class="loading" id="loadingSection">
      <div class="spinner"></div>
      <h3>🧠 Analyzing your resume...</h3>
      <p>Our AI is examining your resume for ATS compatibility, job matches, and optimization opportunities.</p>
    </div>

    <!-- Results -->
    <div class="results" id="resultsSection">
      <div class="score-cards">
        <div class="score-card">
          <div class="icon ats-score">📊</div>
          <div class="value ats-score" id="atsScore">--</div>
          <div class="label">ATS Score</div>
        </div>
        <div class="score-card">
          <div class="icon job-match">💼</div>
          <div class="value job-match" id="jobMatch">--</div>
          <div class="label">Best Job Match</div>
        </div>
        <div class="score-card">
          <div class="icon keywords">🔧</div>
          <div class="value keywords" id="keywordsCount">--</div>
          <div class="label">Technical Keywords</div>
        </div>
        <div class="score-card">
          <div class="icon improvement">📈</div>
          <div class="value improvement" id="improvementPotential">--</div>
          <div class="label">Improvement Potential</div>
        </div>
      </div>

      <div class="analysis-card">
        <div class="analysis-header">💼 Job Profile Compatibility</div>
        <div class="analysis-content" id="profileMatches"></div>
      </div>

      <div class="analysis-card">
        <div class="analysis-header">📋 Section Analysis</div>
        <div class="analysis-content" id="sectionAnalysis"></div>
      </div>

      <div class="analysis-card">
        <div class="analysis-header">🎯 Action Plan</div>
        <div class="analysis-content" id="actionPlan"></div>
      </div>

      <div class="analysis-card" style="text-align: center; padding: 1.5rem;">
        <h3>📥 Download Detailed Report</h3>
        <p>Get a comprehensive PDF report with all analysis details and recommendations</p>
        <a href="#" class="upload-btn" id="downloadBtn">Download Full Report</a>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      © 2025 AI Resume Intelligence System. All rights reserved.
    </footer>
  </div>

  <!-- Existing Script (unchanged for functionality) -->
  <script>
    // Keep your existing JS logic here
    // Global variables
        let analysisData = null;
        
        // File upload handling
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('dragleave', handleDragLeave);
        uploadArea.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);

        function handleDragOver(e) {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            if (!file.type.includes('pdf')) {
                alert('Please select a PDF file');
                return;
            }

            showLoading();
            analyzeResume(file);
        }

        function showLoading() {
            document.getElementById('uploadSection').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
        }

        function showResults() {
            document.getElementById('uploadSection').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
        }

        function analyzeResume(file) {
            const formData = new FormData();
            formData.append('resume', file);

            fetch('/analyze', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    analysisData = data.analysis;
                    displayResults(data.analysis);
                    showResults();
                } else {
                    alert('Error analyzing resume: ' + data.error);
                    location.reload();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while analyzing the resume');
                location.reload();
            });
        }

        function displayResults(analysis) {
            // Update score cards
            document.getElementById('atsScore').textContent = analysis.ats_score + '/100';
            document.getElementById('jobMatch').textContent = analysis.best_job_match.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
            document.getElementById('keywordsCount').textContent = analysis.tech_keywords_found;
            document.getElementById('improvementPotential').textContent = analysis.improvement_potential + '/100';

            // Display job profile matches
            displayProfileMatches(analysis.job_matches);
            
            // Display section analysis
            displaySectionAnalysis(analysis.sections);
            
            // Display action plan
            displayActionPlan(analysis.recommendations);

            // Set up download link
            document.getElementById('downloadBtn').href = '/download/' + analysis.report_id;
        }

        function displayProfileMatches(jobMatches) {
            const container = document.getElementById('profileMatches');
            container.innerHTML = '';

            // Sort by score
            const sortedMatches = Object.entries(jobMatches).sort((a, b) => b[1].score - a[1].score);

            sortedMatches.slice(0, 6).forEach(([profileId, match]) => {
                const profileCard = document.createElement('div');
                profileCard.className = 'profile-card';
                
                const compatibilityPercent = Math.round(match.score);
                
                profileCard.innerHTML = `
                    <div class="profile-title">${match.title}</div>
                    <div class="compatibility-bar">
                        <div class="compatibility-fill" style="width: ${compatibilityPercent}%"></div>
                    </div>
                    <div style="text-align: center; font-weight: bold; color: #667eea;">
                        ${compatibilityPercent}% Compatible
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9rem;">
                        <div>✅ Required: ${match.required_found}/${match.required_total}</div>
                        <div>⭐ Preferred: ${match.preferred_found}/${match.preferred_total}</div>
                    </div>
                    ${match.missing_required.length > 0 ? `
                        <div style="margin-top: 15px;">
                            <div style="font-size: 0.9rem; color: #666; margin-bottom: 8px;">Missing Critical:</div>
                            <div class="keywords-list">
                                ${match.missing_required.slice(0, 3).map(kw => 
                                    `<span class="keyword-tag missing-keyword">${kw}</span>`
                                ).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;
                
                container.appendChild(profileCard);
            });
        }

        function displaySectionAnalysis(sections) {
            const container = document.getElementById('sectionAnalysis');
            container.innerHTML = '';

            Object.entries(sections).forEach(([sectionName, analysis]) => {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'section-analysis';
                
                sectionDiv.innerHTML = `
                    <div class="section-title">📋 ${sectionName.toUpperCase()} Section</div>
                    
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <div class="metric-value">${analysis.word_count}</div>
                            <div class="metric-label">Words</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">${analysis.technical_terms.length}</div>
                            <div class="metric-label">Tech Terms</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">${analysis.action_verbs.length}</div>
                            <div class="metric-label">Action Verbs</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">${Math.round(analysis.benchmark_score)}/100</div>
                            <div class="metric-label">Score</div>
                        </div>
                    </div>

                    ${analysis.strengths.length > 0 ? `
                        <div style="background: #e8f5e8; border-left: 4px solid #28a745; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <h4 style="color: #28a745; margin-bottom: 10px;">✅ Strengths</h4>
                            <ul style="list-style: none; padding: 0;">
                                ${analysis.strengths.map(strength => `<li style="padding: 3px 0;">${strength}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}

                    ${analysis.issues.length > 0 ? `
                        <div style="background: #ffeaa7; border-left: 4px solid #fdcb6e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <h4 style="color: #e17055; margin-bottom: 10px;">⚠️ Issues</h4>
                            <ul style="list-style: none; padding: 0;">
                                ${analysis.issues.map(issue => `<li style="padding: 3px 0;">${issue}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}

                    ${analysis.recommendations.length > 0 ? `
                        <div class="recommendations">
                            <h4>💡 Recommendations</h4>
                            <ul>
                                ${analysis.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                `;
                
                container.appendChild(sectionDiv);
            });
        }

        function displayActionPlan(recommendations) {
            const container = document.getElementById('actionPlan');
            
            container.innerHTML = `
                <div class="priority-section">
                    <div class="priority-title priority-critical">🚨 Critical Priority Actions</div>
                    ${recommendations.critical.map(action => `
                        <div class="action-item">${action}</div>
                    `).join('')}
                </div>

                <div class="priority-section">
                    <div class="priority-title priority-high">⚠️ High Priority Actions</div>
                    ${recommendations.high.map(action => `
                        <div class="action-item">${action}</div>
                    `).join('')}
                </div>

                <div class="priority-section">
                    <div class="priority-title priority-medium">💡 Medium Priority Improvements</div>
                    ${recommendations.medium.map(action => `
                        <div class="action-item">${action}</div>
                    `).join('')}
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px; text-align: center;">
                    <h4 style="color: #667eea; margin-bottom: 15px;">📈 Predicted Improvements</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;">+35%</div>
                            <div style="color: #666;">Interview Likelihood</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: #17a2b8;">+15 pts</div>
                            <div style="color: #666;">ATS Score Boost</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: #ffc107;">+20%</div>
                            <div style="color: #666;">Job Match Rate</div>
                        </div>
                    </div>
                </div>
            `;
        }
  </script>
</body>
</html>
